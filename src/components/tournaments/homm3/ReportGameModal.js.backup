import React, { useState } from 'react';
import classes from './ReportGameModal.module.css';

// Import local castle images
import castleImg from '../../../image/castles/castle.jpeg';
import rampartImg from '../../../image/castles/rampart.jpeg';
import towerImg from '../../../image/castles/tower.jpeg';
import infernoImg from '../../../image/castles/inferno.jpeg';
import necropolisImg from '../../../image/castles/necropolis.jpeg';
import dungeonImg from '../../../image/castles/dungeon.jpeg';
import strongholdImg from '../../../image/castles/stronghold.jpeg';
import fortressImg from '../../../image/castles/fortress.jpeg';
import confluxImg from '../../../image/castles/conflux.jpeg';
import coveImg from '../../../image/castles/cove.jpeg';
import factoryImg from '../../../image/castles/factory.jpeg';
import kronverkImg from '../../../image/castles/kronverk.jpeg';

const ReportGameModal = ({ pair, onClose, onSubmit }) => {
    const [selectedWinner, setSelectedWinner] = useState(pair.winner || '');
    const [castle1, setCastle1] = useState('');
    const [castle2, setCastle2] = useState('');
    const [score1, setScore1] = useState(pair.score1 || 0);
    const [score2, setScore2] = useState(pair.score2 || 0);
    const [gameResults, setGameResults] = useState([]);
    const [color1, setColor1] = useState('red'); // Default color for team1
    const [color2, setColor2] = useState('blue'); // Default color for team2
    const [gold1, setGold1] = useState(0); // Gold for team1
    const [gold2, setGold2] = useState(0); // Gold for team2
    const [restart1_111, setRestart1_111] = useState(0); // 111 restarts for team1 (max 2)
    const [restart1_112, setRestart1_112] = useState(0); // 112 restarts for team1 (max 1)
    const [restart2_111, setRestart2_111] = useState(0); // 111 restarts for team2 (max 2)
    const [restart2_112, setRestart2_112] = useState(0); // 112 restarts for team2 (max 1)

    // Available castles - using database format with Russian names
    const castles = [
        'Castle-Замок',
        'Rampart-Оплот',
        'Tower-Башня',
        'Inferno-Инферно',
        'Necropolis-Некрополис',
        'Dungeon-Подземелье',
        'Stronghold-Цитадель',
        'Fortress-Болото',
        'Conflux-Сопряжение',
        'Cove-Пиратская бухта',
        'Factory-Фабрика',
        'Kronverk-Кронверк'
    ];

    // Map castle names to imported images
    const getCastleImageUrl = (castleName) => {
        // Extract English name from "Castle-Замок" format
        const englishName = castleName.split('-')[0];
        const castleImages = {
            Castle: castleImg,
            Rampart: rampartImg,
            Tower: towerImg,
            Inferno: infernoImg,
            Necropolis: necropolisImg,
            Dungeon: dungeonImg,
            Stronghold: strongholdImg,
            Fortress: fortressImg,
            Conflux: confluxImg,
            Cove: coveImg,
            Factory: factoryImg,
            Kronverk: kronverkImg
        };
        return castleImages[englishName] || '';
    };

    // Initialize game results for bo-3
    React.useEffect(() => {
        // Initialize winner and scores from pair
        setSelectedWinner(pair.winner || '');
        setScore1(pair.score1 || 0);
        setScore2(pair.score2 || 0);

        // Initialize colors from pair data if available
        if (pair.color1) setColor1(pair.color1);
        if (pair.color2) setColor2(pair.color2);

        if (pair.type === 'bo-3') {
            setGameResults(
                pair.games.map((game, idx) => ({
                    gameId: idx,
                    castle1: game.castle1 || '',
                    castle2: game.castle2 || '',
                    winner: game.gameWinner || '',
                    gameStatus: game.gameStatus || 'Not Started',
                    color1: game.color1 || 'red',
                    color2: game.color2 || 'blue',
                    gold1: game.gold1 || 0,
                    gold2: game.gold2 || 0,
                    restart1_111: game.restart1_111 || 0,
                    restart1_112: game.restart1_112 || 0,
                    restart2_111: game.restart2_111 || 0,
                    restart2_112: game.restart2_112 || 0
                }))
            );
        } else {
            // Initialize bo-1 with existing castle data if available
            if (pair.games && pair.games[0]) {
                setCastle1(pair.games[0].castle1 || '');
                setCastle2(pair.games[0].castle2 || '');
                if (pair.games[0].color1) setColor1(pair.games[0].color1);
                if (pair.games[0].color2) setColor2(pair.games[0].color2);
                if (pair.games[0].gold1) setGold1(pair.games[0].gold1);
                if (pair.games[0].gold2) setGold2(pair.games[0].gold2);
                if (pair.games[0].restart1_111) setRestart1_111(pair.games[0].restart1_111);
                if (pair.games[0].restart1_112) setRestart1_112(pair.games[0].restart1_112);
                if (pair.games[0].restart2_111) setRestart2_111(pair.games[0].restart2_111);
                if (pair.games[0].restart2_112) setRestart2_112(pair.games[0].restart2_112);
            }
        }
    }, [pair]);

    const handleGameResultChange = (gameIdx, field, value) => {
        const updated = [...gameResults];
        updated[gameIdx] = { ...updated[gameIdx], [field]: value };

        // Auto-calculate scores based on winners
        const team1Wins = updated.filter((g) => g.winner === pair.team1).length;
        const team2Wins = updated.filter((g) => g.winner === pair.team2).length;
        setScore1(team1Wins);
        setScore2(team2Wins);

        // Auto-add Game 3 if score is 1-1 and only 2 games exist
        if (team1Wins === 1 && team2Wins === 1 && updated.length === 2) {
            updated.push({
                gameId: 2,
                castle1: '',
                castle2: '',
                winner: '',
                color1: 'red',
                color2: 'blue',
                gold1: 0,
                gold2: 0,
                restart1_111: 0,
                restart1_112: 0,
                restart2_111: 0,
                restart2_112: 0
            });
        }

        setGameResults(updated);

        // Auto-select winner if reached 2 wins
        if (team1Wins >= 2) {
            setSelectedWinner(pair.team1);
        } else if (team2Wins >= 2) {
            setSelectedWinner(pair.team2);
        }
    };

    const handleSubmit = (e) => {
        e.preventDefault();

        // Validate based on what's being reported
        if (pair.type === 'bo-3') {
            // For bo-3, validate each game that has any data filled in
            for (let i = 0; i < gameResults.length; i++) {
                const game = gameResults[i];
                // If game has a winner, it must have castles
                if (game.winner && (!game.castle1 || !game.castle2)) {
                    alert(`Game ${i + 1}: Please select castles for both players before selecting a winner`);
                    return;
                }
                // If game has castles selected, it should be complete (have both castles)
                if ((game.castle1 || game.castle2) && (!game.castle1 || !game.castle2)) {
                    alert(`Game ${i + 1}: Please select castles for both players`);
                    return;
                }
            }

            // If overall winner is selected, validate the series is properly concluded
            if (selectedWinner) {
                if ((score1 !== 2 && score2 !== 2) || (score1 === 2 && score2 === 2)) {
                    alert('Invalid score for BO-3. One player must have exactly 2 wins to determine a match winner.');
                    return;
                }
            }
        } else {
            // Validate bo-1
            if (selectedWinner) {
                if (!castle1 || !castle2) {
                    alert('Please select castles for both players');
                    return;
                }
                if (score1 + score2 !== 1) {
                    alert('Score must be 1-0 or 0-1 for BO-1');
                    return;
                }
            }
        }

        const reportData = {
            winner: selectedWinner || null,
            score1: score1,
            score2: score2,
            color1: color1,
            color2: color2,
            games:
                pair.type === 'bo-3'
                    ? gameResults.map((g) => ({
                          castle1: g.castle1 || '',
                          castle2: g.castle2 || '',
                          castleWinner: g.winner ? (g.winner === pair.team1 ? g.castle1 : g.castle2) : '',
                          gameWinner: g.winner || '',
                          gameStatus:
                              g.gameStatus === 'Processed' ? 'Processed' : g.winner ? 'Finished' : 'In Progress',
                          gameId: g.gameId,
                          color1: g.color1 || color1,
                          color2: g.color2 || color2,
                          gold1: g.gold1 || 0,
                          gold2: g.gold2 || 0,
                          restart1_111: g.restart1_111 || 0,
                          restart1_112: g.restart1_112 || 0,
                          restart2_111: g.restart2_111 || 0,
                          restart2_112: g.restart2_112 || 0
                      }))
                    : [
                          {
                              castle1: castle1 || '',
                              castle2: castle2 || '',
                              castleWinner: selectedWinner ? (selectedWinner === pair.team1 ? castle1 : castle2) : '',
                              gameWinner: selectedWinner || '',
                              gameStatus: selectedWinner ? 'Finished' : 'In Progress',
                              gameId: 0,
                              color1: color1,
                              color2: color2,
                              gold1: gold1,
                              gold2: gold2,
                              restart1_111: restart1_111,
                              restart1_112: restart1_112,
                              restart2_111: restart2_111,
                              restart2_112: restart2_112
                          }
                      ]
        };

        onSubmit(reportData);
    };

    return (
        <div className={classes.backdrop} onClick={onClose}>
            <div className={classes.modal} onClick={(e) => e.stopPropagation()}>
                <button className={classes.closeButton} onClick={onClose}>
                    ×
                </button>
                <h2 className={classes.title}>Report Game Result - {pair.type.toUpperCase()}</h2>

                <form onSubmit={handleSubmit} className={classes.form}>
                    {pair.type === 'bo-3' ? (
                        <>
                            {/* BO-3 Game Results */}
                            {gameResults.map((game, idx) => (
                                <div key={idx} className={classes.gameSection}>
                                    <h3 className={classes.gameTitle}>Game {idx + 1}</h3>

                                    {/* Compact Score/Winner Section */}
                                    <div className={classes.formGroup}>
                                        <div
                                            style={{
                                                display: 'flex',
                                                alignItems: 'center',
                                                justifyContent: 'center',
                                                gap: '1rem',
                                                marginBottom: '1rem',
                                                padding: '0.75rem',
                                                background:
                                                    'linear-gradient(135deg, rgba(62, 32, 192, 0.2), rgba(45, 20, 150, 0.2))',
                                                borderRadius: '8px',
                                                border: '2px solid #FFD700'
                                            }}
                                        >
                                            <div
                                                onClick={() => handleGameResultChange(idx, 'winner', pair.team1)}
                                                style={{
                                                    cursor: 'pointer',
                                                    padding: '0.5rem 1rem',
                                                    borderRadius: '6px',
                                                    border:
                                                        game.winner === pair.team1
                                                            ? '3px solid #FFD700'
                                                            : '2px solid transparent',
                                                    background:
                                                        game.winner === pair.team1
                                                            ? 'rgba(255, 215, 0, 0.2)'
                                                            : 'transparent',
                                                    color: '#00ffff',
                                                    fontSize: '14px',
                                                    fontWeight: 'bold',
                                                    opacity: game.winner === pair.team1 ? 1 : 0.6,
                                                    transition: 'all 0.2s ease'
                                                }}
                                            >
                                                {pair.team1}
                                            </div>
                                            <div
                                                style={{
                                                    fontSize: '20px',
                                                    fontWeight: 'bold',
                                                    color: '#FFD700'
                                                }}
                                            >
                                                {score1} - {score2}
                                            </div>
                                            <div
                                                onClick={() => handleGameResultChange(idx, 'winner', pair.team2)}
                                                style={{
                                                    cursor: 'pointer',
                                                    padding: '0.5rem 1rem',
                                                    borderRadius: '6px',
                                                    border:
                                                        game.winner === pair.team2
                                                            ? '3px solid #FFD700'
                                                            : '2px solid transparent',
                                                    background:
                                                        game.winner === pair.team2
                                                            ? 'rgba(255, 215, 0, 0.2)'
                                                            : 'transparent',
                                                    color: '#00ffff',
                                                    fontSize: '14px',
                                                    fontWeight: 'bold',
                                                    opacity: game.winner === pair.team2 ? 1 : 0.6,
                                                    transition: 'all 0.2s ease'
                                                }}
                                            >
                                                {pair.team2}
                                            </div>
                                        </div>
                                    </div>

                                    {/* Compact Metadata Section - Colors, Gold, Restarts */}
                                    <div className={classes.formGroup}>
                                        <div
                                            style={{
                                                display: 'grid',
                                                gridTemplateColumns: '1fr 1fr 1fr',
                                                gap: '1rem',
                                                padding: '1rem',
                                                background: 'rgba(0, 0, 0, 0.2)',
                                                borderRadius: '8px',
                                                border: '1px solid rgba(0, 255, 255, 0.3)'
                                            }}
                                        >
                                            {/* Player Colors Column */}
                                            <div>
                                                <div
                                                    style={{
                                                        textAlign: 'center',
                                                        marginBottom: '0.5rem',
                                                        color: '#FFD700',
                                                        fontSize: '12px',
                                                        fontWeight: 'bold'
                                                    }}
                                                >
                                                    Colors
                                                </div>
                                                <div
                                                    style={{ display: 'flex', gap: '0.5rem', justifyContent: 'center' }}
                                                >
                                                    <div
                                                        onClick={() => {
                                                            const updated = [...gameResults];
                                                            updated[idx] = {
                                                                ...updated[idx],
                                                                color1: 'red',
                                                                color2: 'blue'
                                                            };
                                                            setGameResults(updated);
                                                        }}
                                                        style={{
                                                            width: '40px',
                                                            height: '40px',
                                                            borderRadius: '6px',
                                                            background:
                                                                'linear-gradient(135deg, #8B0000, #FF0000)',
                                                            border:
                                                                game.color1 === 'red'
                                                                    ? '3px solid #FFD700'
                                                                    : '2px solid #4a0000',
                                                            cursor: 'pointer',
                                                            display: 'flex',
                                                            alignItems: 'center',
                                                            justifyContent: 'center',
                                                            opacity: game.color1 === 'red' ? 1 : 0.5
                                                        }}
                                                    >
                                                        {game.color1 === 'red' && (
                                                            <span style={{ color: '#FFD700', fontSize: '16px' }}>✓</span>
                                                        )}
                                                    </div>
                                                    <div
                                                        onClick={() => {
                                                            const updated = [...gameResults];
                                                            updated[idx] = {
                                                                ...updated[idx],
                                                                color1: 'blue',
                                                                color2: 'red'
                                                            };
                                                            setGameResults(updated);
                                                        }}
                                                        style={{
                                                            width: '40px',
                                                            height: '40px',
                                                            borderRadius: '6px',
                                                            background:
                                                                'linear-gradient(135deg, #00008B, #0000FF)',
                                                            border:
                                                                game.color1 === 'blue'
                                                                    ? '3px solid #FFD700'
                                                                    : '2px solid #000045',
                                                            cursor: 'pointer',
                                                            display: 'flex',
                                                            alignItems: 'center',
                                                            justifyContent: 'center',
                                                            opacity: game.color1 === 'blue' ? 1 : 0.5
                                                        }}
                                                    >
                                                        {game.color1 === 'blue' && (
                                                            <span style={{ color: '#FFD700', fontSize: '16px' }}>✓</span>
                                                        )}
                                                    </div>
                                                </div>
                                            </div>

                                            {/* Gold Column */}
                                            <div>
                                                <div
                                                    style={{
                                                        textAlign: 'center',
                                                        marginBottom: '0.5rem',
                                                        color: '#FFD700',
                                                        fontSize: '12px',
                                                        fontWeight: 'bold'
                                                    }}
                                                >
                                                    Gold
                                                </div>
                                                <input
                                                    type="number"
                                                    value={game.gold1 || 0}
                                                    onChange={(e) => {
                                                        const value = parseInt(e.target.value) || 0;
                                                        const updated = [...gameResults];
                                                        updated[idx] = {
                                                            ...updated[idx],
                                                            gold1: value,
                                                            gold2: -value
                                                        };
                                                        setGameResults(updated);
                                                    }}
                                                    style={{
                                                        width: '80px',
                                                        padding: '0.4rem',
                                                        fontSize: '14px',
                                                        textAlign: 'center',
                                                        border: '2px solid #FFD700',
                                                        borderRadius: '6px',
                                                        background: 'rgba(62, 32, 192, 0.2)',
                                                        color:
                                                            (game.gold1 || 0) > 0
                                                                ? '#00FF00'
                                                                : (game.gold1 || 0) < 0
                                                                  ? '#FF0000'
                                                                  : '#FFD700',
                                                        fontWeight: 'bold'
                                                    }}
                                                />
                                            </div>

                                            {/* Restarts Column */}
                                            <div>
                                                <div
                                                    style={{
                                                        textAlign: 'center',
                                                        marginBottom: '0.5rem',
                                                        color: '#FFD700',
                                                        fontSize: '12px',
                                                        fontWeight: 'bold'
                                                    }}
                                                >
                                                    Restarts
                                                </div>
                                                <div
                                                    style={{
                                                        display: 'flex',
                                                        gap: '0.25rem',
                                                        justifyContent: 'center'
                                                    }}
                                                >
                                                    {[0, 1].map((boxIdx) => {
                                                        const isUsed = (game.restart1_111 || 0) > boxIdx;
                                                        const isDisabled = (game.restart1_112 || 0) > 0;
                                                        return (
                                                            <div
                                                                key={`111-${boxIdx}`}
                                                                onClick={() => {
                                                                    if (isDisabled) return;
                                                                    const updated = [...gameResults];
                                                                    const current = updated[idx].restart1_111 || 0;
                                                                    if (isUsed) {
                                                                        updated[idx] = {
                                                                            ...updated[idx],
                                                                            restart1_111: current - 1
                                                                        };
                                                                    } else if (current < 2) {
                                                                        updated[idx] = {
                                                                            ...updated[idx],
                                                                            restart1_111: current + 1
                                                                        };
                                                                    }
                                                                    setGameResults(updated);
                                                                }}
                                                                style={{
                                                                    position: 'relative',
                                                                    width: '35px',
                                                                    height: '35px',
                                                                    border: '2px solid #FFD700',
                                                                    borderRadius: '4px',
                                                                    background: isDisabled
                                                                        ? 'rgba(0, 0, 0, 0.5)'
                                                                        : isUsed
                                                                          ? 'rgba(62, 32, 192, 0.3)'
                                                                          : 'rgba(0, 0, 0, 0.3)',
                                                                    cursor: isDisabled ? 'not-allowed' : 'pointer',
                                                                    display: 'flex',
                                                                    alignItems: 'center',
                                                                    justifyContent: 'center',
                                                                    opacity: isDisabled ? 0.4 : isUsed ? 1 : 0.5,
                                                                    fontSize: '10px',
                                                                    color: '#FFD700',
                                                                    fontWeight: 'bold'
                                                                }}
                                                            >
                                                                111
                                                                {isUsed && (
                                                                    <div
                                                                        style={{
                                                                            position: 'absolute',
                                                                            fontSize: '28px',
                                                                            color: '#FF0000'
                                                                        }}
                                                                    >
                                                                        ✕
                                                                    </div>
                                                                )}
                                                            </div>
                                                        );
                                                    })}
                                                    <div
                                                        onClick={() => {
                                                            const updated = [...gameResults];
                                                            const current = updated[idx].restart1_112 || 0;
                                                            const is111Used = (updated[idx].restart1_111 || 0) > 0;
                                                            if (is111Used) return;
                                                            updated[idx] = {
                                                                ...updated[idx],
                                                                restart1_112: current === 1 ? 0 : 1
                                                            };
                                                            setGameResults(updated);
                                                        }}
                                                        style={{
                                                            position: 'relative',
                                                            width: '35px',
                                                            height: '35px',
                                                            border: '2px solid #FFD700',
                                                            borderRadius: '4px',
                                                            background:
                                                                (game.restart1_111 || 0) > 0
                                                                    ? 'rgba(0, 0, 0, 0.5)'
                                                                    : (game.restart1_112 || 0) === 1
                                                                      ? 'rgba(62, 32, 192, 0.3)'
                                                                      : 'rgba(0, 0, 0, 0.3)',
                                                            cursor:
                                                                (game.restart1_111 || 0) > 0 ? 'not-allowed' : 'pointer',
                                                            display: 'flex',
                                                            alignItems: 'center',
                                                            justifyContent: 'center',
                                                            opacity:
                                                                (game.restart1_111 || 0) > 0
                                                                    ? 0.4
                                                                    : (game.restart1_112 || 0) === 1
                                                                      ? 1
                                                                      : 0.5,
                                                            fontSize: '10px',
                                                            color: '#FFD700',
                                                            fontWeight: 'bold'
                                                        }}
                                                    >
                                                        112
                                                        {(game.restart1_112 || 0) === 1 && (
                                                            <div
                                                                style={{
                                                                    position: 'absolute',
                                                                    fontSize: '28px',
                                                                    color: '#FF0000'
                                                                }}
                                                            >
                                                                ✕
                                                            </div>
                                                        )}
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                    <div className={classes.formGroup}>
                                        <label>{pair.team1} Castle:</label>
                                        <div
                                            style={{
                                                display: 'grid',
                                                gridTemplateColumns: 'repeat(6, 1fr)',
                                                gap: '0.5rem',
                                                maxWidth: '600px'
                                            }}
                                        >
                                            {castles.map((c) => (
                                                <img
                                                    key={c}
                                                    src={getCastleImageUrl(c)}
                                                    alt={c}
                                                    title={c}
                                                    style={{
                                                        width: '90px',
                                                        height: '60px',
                                                        border:
                                                            game.castle1 === c
                                                                ? '3px solid #FFD700'
                                                                : '2px solid #00ffff',
                                                        borderRadius: '4px',
                                                        objectFit: 'cover',
                                                        cursor: 'pointer',
                                                        opacity: game.castle1 === c ? 1 : 0.6,
                                                        transform: game.castle1 === c ? 'scale(1.05)' : 'scale(1)',
                                                        transition: 'all 0.2s ease'
                                                    }}
                                                    onClick={() => handleGameResultChange(idx, 'castle1', c)}
                                                />
                                            ))}
                                        </div>
                                    </div>
                                    <div className={classes.formGroup}>
                                        <label>{pair.team2} Castle:</label>
                                        <div
                                            style={{
                                                display: 'grid',
                                                gridTemplateColumns: 'repeat(6, 1fr)',
                                                gap: '0.5rem',
                                                maxWidth: '600px'
                                            }}
                                        >
                                            {castles.map((c) => (
                                                <img
                                                    key={c}
                                                    src={getCastleImageUrl(c)}
                                                    alt={c}
                                                    title={c}
                                                    style={{
                                                        width: '90px',
                                                        height: '60px',
                                                        border:
                                                            game.castle2 === c
                                                                ? '3px solid #FFD700'
                                                                : '2px solid #00ffff',
                                                        borderRadius: '4px',
                                                        objectFit: 'cover',
                                                        cursor: 'pointer',
                                                        opacity: game.castle2 === c ? 1 : 0.6,
                                                        transform: game.castle2 === c ? 'scale(1.05)' : 'scale(1)',
                                                        transition: 'all 0.2s ease'
                                                    }}
                                                    onClick={() => handleGameResultChange(idx, 'castle2', c)}
                                                />
                                            ))}
                                        </div>
                                    </div>
                                </div>
                            ))}
                        </>
                    ) : (
                        <>
                            {/* BO-1 Game Result */}

                            {/* Compact Score/Winner Section for BO-1 */}
                            <div className={classes.formGroup}>
                                <div
                                    style={{
                                        display: 'flex',
                                        alignItems: 'center',
                                        justifyContent: 'center',
                                        gap: '1rem',
                                        marginBottom: '1rem',
                                        padding: '0.75rem',
                                        background:
                                            'linear-gradient(135deg, rgba(62, 32, 192, 0.2), rgba(45, 20, 150, 0.2))',
                                        borderRadius: '8px',
                                        border: '2px solid #FFD700'
                                    }}
                                >
                                                            display: 'flex',
                                                            alignItems: 'center',
                                                            justifyContent: 'center'
                                                        }}
                                                    >
                                                        {game.color1 === 'red' && (
                                                            <span
                                                                style={{
                                                                    color: '#FFD700',
                                                                    fontSize: '24px',
                                                                    fontWeight: 'bold'
                                                                }}
                                                            >
                                                                ✓
                                                            </span>
                                                        )}
                                                    </div>
                                                    <div
                                                        onClick={() => {
                                                            const updated = [...gameResults];
                                                            updated[idx] = {
                                                                ...updated[idx],
                                                                color1: 'blue',
                                                                color2: 'red'
                                                            };
                                                            setGameResults(updated);
                                                        }}
                                                        style={{
                                                            width: '60px',
                                                            height: '60px',
                                                            borderRadius: '8px',
                                                            background:
                                                                'linear-gradient(135deg, #00008B, #0000FF, #4169E1)',
                                                            border:
                                                                game.color1 === 'blue'
                                                                    ? '4px solid #FFD700'
                                                                    : '3px solid #000045',
                                                            cursor: 'pointer',
                                                            boxShadow:
                                                                game.color1 === 'blue'
                                                                    ? '0 0 20px rgba(0, 0, 255, 0.8), inset 0 0 20px rgba(255, 255, 255, 0.2)'
                                                                    : '0 4px 8px rgba(0, 0, 0, 0.5), inset 0 2px 4px rgba(255, 255, 255, 0.1)',
                                                            transform:
                                                                game.color1 === 'blue' ? 'scale(1.1)' : 'scale(1)',
                                                            transition: 'all 0.2s ease',
                                                            display: 'flex',
                                                            alignItems: 'center',
                                                            justifyContent: 'center'
                                                        }}
                                                    >
                                                        {game.color1 === 'blue' && (
                                                            <span
                                                                style={{
                                                                    color: '#FFD700',
                                                                    fontSize: '24px',
                                                                    fontWeight: 'bold'
                                                                }}
                                                            >
                                                                ✓
                                                            </span>
                                                        )}
                                                    </div>
                                                </div>
                                            </div>
                                            <div style={{ textAlign: 'center' }}>
                                                <div
                                                    style={{
                                                        marginBottom: '0.5rem',
                                                        color: '#00ffff',
                                                        fontSize: '14px'
                                                    }}
                                                >
                                                    {pair.team2}
                                                </div>
                                                <div style={{ display: 'flex', gap: '0.5rem' }}>
                                                    <div
                                                        onClick={() => {
                                                            const updated = [...gameResults];
                                                            updated[idx] = {
                                                                ...updated[idx],
                                                                color2: 'red',
                                                                color1: 'blue'
                                                            };
                                                            setGameResults(updated);
                                                        }}
                                                        style={{
                                                            width: '60px',
                                                            height: '60px',
                                                            borderRadius: '8px',
                                                            background:
                                                                'linear-gradient(135deg, #8B0000, #FF0000, #DC143C)',
                                                            border:
                                                                game.color2 === 'red'
                                                                    ? '4px solid #FFD700'
                                                                    : '3px solid #4a0000',
                                                            cursor: 'pointer',
                                                            boxShadow:
                                                                game.color2 === 'red'
                                                                    ? '0 0 20px rgba(255, 0, 0, 0.8), inset 0 0 20px rgba(255, 255, 255, 0.2)'
                                                                    : '0 4px 8px rgba(0, 0, 0, 0.5), inset 0 2px 4px rgba(255, 255, 255, 0.1)',
                                                            transform:
                                                                game.color2 === 'red' ? 'scale(1.1)' : 'scale(1)',
                                                            transition: 'all 0.2s ease',
                                                            display: 'flex',
                                                            alignItems: 'center',
                                                            justifyContent: 'center'
                                                        }}
                                                    >
                                                        {game.color2 === 'red' && (
                                                            <span
                                                                style={{
                                                                    color: '#FFD700',
                                                                    fontSize: '24px',
                                                                    fontWeight: 'bold'
                                                                }}
                                                            >
                                                                ✓
                                                            </span>
                                                        )}
                                                    </div>
                                                    <div
                                                        onClick={() => {
                                                            const updated = [...gameResults];
                                                            updated[idx] = {
                                                                ...updated[idx],
                                                                color2: 'blue',
                                                                color1: 'red'
                                                            };
                                                            setGameResults(updated);
                                                        }}
                                                        style={{
                                                            width: '60px',
                                                            height: '60px',
                                                            borderRadius: '8px',
                                                            background:
                                                                'linear-gradient(135deg, #00008B, #0000FF, #4169E1)',
                                                            border:
                                                                game.color2 === 'blue'
                                                                    ? '4px solid #FFD700'
                                                                    : '3px solid #000045',
                                                            cursor: 'pointer',
                                                            boxShadow:
                                                                game.color2 === 'blue'
                                                                    ? '0 0 20px rgba(0, 0, 255, 0.8), inset 0 0 20px rgba(255, 255, 255, 0.2)'
                                                                    : '0 4px 8px rgba(0, 0, 0, 0.5), inset 0 2px 4px rgba(255, 255, 255, 0.1)',
                                                            transform:
                                                                game.color2 === 'blue' ? 'scale(1.1)' : 'scale(1)',
                                                            transition: 'all 0.2s ease',
                                                            display: 'flex',
                                                            alignItems: 'center',
                                                            justifyContent: 'center'
                                                        }}
                                                    >
                                                        {game.color2 === 'blue' && (
                                                            <span
                                                                style={{
                                                                    color: '#FFD700',
                                                                    fontSize: '24px',
                                                                    fontWeight: 'bold'
                                                                }}
                                                            >
                                                                ✓
                                                            </span>
                                                        )}
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                    {/* Gold Input for BO-3 */}
                                    <div className={classes.formGroup}>
                                        <label>Gold Advantage:</label>
                                        <div
                                            style={{
                                                display: 'flex',
                                                gap: '2rem',
                                                justifyContent: 'center',
                                                alignItems: 'center',
                                                marginBottom: '1rem'
                                            }}
                                        >
                                            <div style={{ textAlign: 'center' }}>
                                                <div
                                                    style={{
                                                        marginBottom: '0.5rem',
                                                        color: '#00ffff',
                                                        fontSize: '14px'
                                                    }}
                                                >
                                                    {pair.team1}
                                                </div>
                                                <input
                                                    type="number"
                                                    value={game.gold1 || 0}
                                                    onChange={(e) => {
                                                        const value = parseInt(e.target.value) || 0;
                                                        const updated = [...gameResults];
                                                        updated[idx] = { ...updated[idx], gold1: value, gold2: -value };
                                                        setGameResults(updated);
                                                    }}
                                                    style={{
                                                        width: '120px',
                                                        padding: '0.5rem',
                                                        fontSize: '16px',
                                                        textAlign: 'center',
                                                        border: '3px solid #FFD700',
                                                        borderRadius: '8px',
                                                        background:
                                                            'linear-gradient(135deg, rgba(62, 32, 192, 0.3), rgba(45, 20, 150, 0.3))',
                                                        color:
                                                            game.gold1 > 0
                                                                ? '#00FF00'
                                                                : game.gold1 < 0
                                                                  ? '#FF0000'
                                                                  : '#FFD700',
                                                        fontWeight: 'bold',
                                                        boxShadow:
                                                            '0 2px 8px rgba(62, 32, 192, 0.3), inset 0 1px 2px rgba(255, 215, 0, 0.1)'
                                                    }}
                                                />
                                            </div>
                                            <div style={{ color: '#FFD700', fontSize: '24px', fontWeight: 'bold' }}>
                                                ⚔️
                                            </div>
                                            <div style={{ textAlign: 'center' }}>
                                                <div
                                                    style={{
                                                        marginBottom: '0.5rem',
                                                        color: '#00ffff',
                                                        fontSize: '14px'
                                                    }}
                                                >
                                                    {pair.team2}
                                                </div>
                                                <input
                                                    type="number"
                                                    value={game.gold2 || 0}
                                                    onChange={(e) => {
                                                        const value = parseInt(e.target.value) || 0;
                                                        const updated = [...gameResults];
                                                        updated[idx] = { ...updated[idx], gold2: value, gold1: -value };
                                                        setGameResults(updated);
                                                    }}
                                                    style={{
                                                        width: '120px',
                                                        padding: '0.5rem',
                                                        fontSize: '16px',
                                                        textAlign: 'center',
                                                        border: '3px solid #FFD700',
                                                        borderRadius: '8px',
                                                        background:
                                                            'linear-gradient(135deg, rgba(62, 32, 192, 0.3), rgba(45, 20, 150, 0.3))',
                                                        color:
                                                            game.gold2 > 0
                                                                ? '#00FF00'
                                                                : game.gold2 < 0
                                                                  ? '#FF0000'
                                                                  : '#FFD700',
                                                        fontWeight: 'bold',
                                                        boxShadow:
                                                            '0 2px 8px rgba(62, 32, 192, 0.3), inset 0 1px 2px rgba(255, 215, 0, 0.1)'
                                                    }}
                                                />
                                            </div>
                                        </div>
                                    </div>

                                    {/* Restarts Input for BO-3 */}
                                    <div className={classes.formGroup}>
                                        <label>Restarts:</label>
                                        <div
                                            style={{
                                                display: 'flex',
                                                gap: '2rem',
                                                justifyContent: 'center',
                                                marginBottom: '1rem'
                                            }}
                                        >
                                            <div style={{ textAlign: 'center' }}>
                                                <div
                                                    style={{
                                                        marginBottom: '0.5rem',
                                                        color: '#00ffff',
                                                        fontSize: '14px'
                                                    }}
                                                >
                                                    {pair.team1}
                                                </div>
                                                <div style={{ display: 'flex', gap: '0.5rem', alignItems: 'center' }}>
                                                    {/* 111 Restart Boxes */}
                                                    {[0, 1].map((boxIdx) => {
                                                        const isUsed = (game.restart1_111 || 0) > boxIdx;
                                                        const isDisabled = (game.restart1_112 || 0) > 0;
                                                        return (
                                                            <div
                                                                key={`111-${boxIdx}`}
                                                                onClick={() => {
                                                                    if (isDisabled) return;
                                                                    const updated = [...gameResults];
                                                                    const current = updated[idx].restart1_111 || 0;
                                                                    if (isUsed) {
                                                                        // Remove one
                                                                        updated[idx] = {
                                                                            ...updated[idx],
                                                                            restart1_111: current - 1
                                                                        };
                                                                    } else if (current < 2) {
                                                                        // Add one
                                                                        updated[idx] = {
                                                                            ...updated[idx],
                                                                            restart1_111: current + 1
                                                                        };
                                                                    }
                                                                    setGameResults(updated);
                                                                }}
                                                                style={{
                                                                    position: 'relative',
                                                                    width: '50px',
                                                                    height: '50px',
                                                                    border: '2px solid #FFD700',
                                                                    borderRadius: '4px',
                                                                    background: isDisabled
                                                                        ? 'rgba(0, 0, 0, 0.5)'
                                                                        : isUsed
                                                                          ? 'linear-gradient(135deg, rgba(62, 32, 192, 0.3), rgba(45, 20, 150, 0.3))'
                                                                          : 'rgba(0, 0, 0, 0.3)',
                                                                    cursor: isDisabled ? 'not-allowed' : 'pointer',
                                                                    display: 'flex',
                                                                    alignItems: 'center',
                                                                    justifyContent: 'center',
                                                                    opacity: isDisabled ? 0.4 : isUsed ? 1 : 0.6,
                                                                    boxShadow: isUsed
                                                                        ? '0 0 10px rgba(255, 215, 0, 0.6)'
                                                                        : 'none'
                                                                }}
                                                            >
                                                                <div
                                                                    style={{
                                                                        color: '#FFD700',
                                                                        fontSize: '14px',
                                                                        fontWeight: 'bold'
                                                                    }}
                                                                >
                                                                    111
                                                                </div>
                                                                {isUsed && (
                                                                    <div
                                                                        style={{
                                                                            position: 'absolute',
                                                                            top: '50%',
                                                                            left: '50%',
                                                                            transform: 'translate(-50%, -50%)',
                                                                            color: '#FF0000',
                                                                            fontSize: '40px',
                                                                            fontWeight: 'bold',
                                                                            lineHeight: '1',
                                                                            textShadow: '0 0 4px #000'
                                                                        }}
                                                                    >
                                                                        ✕
                                                                    </div>
                                                                )}
                                                            </div>
                                                        );
                                                    })}
                                                    {/* 112 Restart Box */}
                                                    <div
                                                        onClick={() => {
                                                            const updated = [...gameResults];
                                                            const current = updated[idx].restart1_112 || 0;
                                                            const is111Used = (updated[idx].restart1_111 || 0) > 0;
                                                            if (is111Used) return;
                                                            updated[idx] = {
                                                                ...updated[idx],
                                                                restart1_112: current === 1 ? 0 : 1
                                                            };
                                                            setGameResults(updated);
                                                        }}
                                                        style={{
                                                            position: 'relative',
                                                            width: '50px',
                                                            height: '50px',
                                                            border: '2px solid #FFD700',
                                                            borderRadius: '4px',
                                                            background:
                                                                (game.restart1_111 || 0) > 0
                                                                    ? 'rgba(0, 0, 0, 0.5)'
                                                                    : (game.restart1_112 || 0) === 1
                                                                      ? 'linear-gradient(135deg, rgba(62, 32, 192, 0.3), rgba(45, 20, 150, 0.3))'
                                                                      : 'rgba(0, 0, 0, 0.3)',
                                                            cursor:
                                                                (game.restart1_111 || 0) > 0
                                                                    ? 'not-allowed'
                                                                    : 'pointer',
                                                            display: 'flex',
                                                            alignItems: 'center',
                                                            justifyContent: 'center',
                                                            opacity:
                                                                (game.restart1_111 || 0) > 0
                                                                    ? 0.4
                                                                    : (game.restart1_112 || 0) === 1
                                                                      ? 1
                                                                      : 0.6,
                                                            boxShadow:
                                                                (game.restart1_112 || 0) === 1
                                                                    ? '0 0 10px rgba(255, 215, 0, 0.6)'
                                                                    : 'none'
                                                        }}
                                                    >
                                                        <div
                                                            style={{
                                                                color: '#FFD700',
                                                                fontSize: '14px',
                                                                fontWeight: 'bold'
                                                            }}
                                                        >
                                                            112
                                                        </div>
                                                        {(game.restart1_112 || 0) === 1 && (
                                                            <div
                                                                style={{
                                                                    position: 'absolute',
                                                                    top: '50%',
                                                                    left: '50%',
                                                                    transform: 'translate(-50%, -50%)',
                                                                    color: '#FF0000',
                                                                    fontSize: '40px',
                                                                    fontWeight: 'bold',
                                                                    lineHeight: '1',
                                                                    textShadow: '0 0 4px #000'
                                                                }}
                                                            >
                                                                ✕
                                                            </div>
                                                        )}
                                                    </div>
                                                </div>
                                            </div>
                                            <div style={{ textAlign: 'center' }}>
                                                <div
                                                    style={{
                                                        marginBottom: '0.5rem',
                                                        color: '#00ffff',
                                                        fontSize: '14px'
                                                    }}
                                                >
                                                    {pair.team2}
                                                </div>
                                                <div style={{ display: 'flex', gap: '0.5rem', alignItems: 'center' }}>
                                                    {/* 111 Restart Boxes */}
                                                    {[0, 1].map((boxIdx) => {
                                                        const isUsed = (game.restart2_111 || 0) > boxIdx;
                                                        const isDisabled = (game.restart2_112 || 0) > 0;
                                                        return (
                                                            <div
                                                                key={`111-${boxIdx}`}
                                                                onClick={() => {
                                                                    if (isDisabled) return;
                                                                    const updated = [...gameResults];
                                                                    const current = updated[idx].restart2_111 || 0;
                                                                    if (isUsed) {
                                                                        // Remove one
                                                                        updated[idx] = {
                                                                            ...updated[idx],
                                                                            restart2_111: current - 1
                                                                        };
                                                                    } else if (current < 2) {
                                                                        // Add one
                                                                        updated[idx] = {
                                                                            ...updated[idx],
                                                                            restart2_111: current + 1
                                                                        };
                                                                    }
                                                                    setGameResults(updated);
                                                                }}
                                                                style={{
                                                                    position: 'relative',
                                                                    width: '50px',
                                                                    height: '50px',
                                                                    border: '2px solid #FFD700',
                                                                    borderRadius: '4px',
                                                                    background: isDisabled
                                                                        ? 'rgba(0, 0, 0, 0.5)'
                                                                        : isUsed
                                                                          ? 'linear-gradient(135deg, rgba(62, 32, 192, 0.3), rgba(45, 20, 150, 0.3))'
                                                                          : 'rgba(0, 0, 0, 0.3)',
                                                                    cursor: isDisabled ? 'not-allowed' : 'pointer',
                                                                    display: 'flex',
                                                                    alignItems: 'center',
                                                                    justifyContent: 'center',
                                                                    opacity: isDisabled ? 0.4 : isUsed ? 1 : 0.6,
                                                                    boxShadow: isUsed
                                                                        ? '0 0 10px rgba(255, 215, 0, 0.6)'
                                                                        : 'none'
                                                                }}
                                                            >
                                                                <div
                                                                    style={{
                                                                        color: '#FFD700',
                                                                        fontSize: '14px',
                                                                        fontWeight: 'bold'
                                                                    }}
                                                                >
                                                                    111
                                                                </div>
                                                                {isUsed && (
                                                                    <div
                                                                        style={{
                                                                            position: 'absolute',
                                                                            top: '50%',
                                                                            left: '50%',
                                                                            transform: 'translate(-50%, -50%)',
                                                                            color: '#FF0000',
                                                                            fontSize: '40px',
                                                                            fontWeight: 'bold',
                                                                            lineHeight: '1',
                                                                            textShadow: '0 0 4px #000'
                                                                        }}
                                                                    >
                                                                        ✕
                                                                    </div>
                                                                )}
                                                            </div>
                                                        );
                                                    })}
                                                    {/* 112 Restart Box */}
                                                    <div
                                                        onClick={() => {
                                                            const updated = [...gameResults];
                                                            const current = updated[idx].restart2_112 || 0;
                                                            const is111Used = (updated[idx].restart2_111 || 0) > 0;
                                                            if (is111Used) return;
                                                            updated[idx] = {
                                                                ...updated[idx],
                                                                restart2_112: current === 1 ? 0 : 1
                                                            };
                                                            setGameResults(updated);
                                                        }}
                                                        style={{
                                                            position: 'relative',
                                                            width: '50px',
                                                            height: '50px',
                                                            border: '2px solid #FFD700',
                                                            borderRadius: '4px',
                                                            background:
                                                                (game.restart2_111 || 0) > 0
                                                                    ? 'rgba(0, 0, 0, 0.5)'
                                                                    : (game.restart2_112 || 0) === 1
                                                                      ? 'linear-gradient(135deg, rgba(62, 32, 192, 0.3), rgba(45, 20, 150, 0.3))'
                                                                      : 'rgba(0, 0, 0, 0.3)',
                                                            cursor:
                                                                (game.restart2_111 || 0) > 0
                                                                    ? 'not-allowed'
                                                                    : 'pointer',
                                                            display: 'flex',
                                                            alignItems: 'center',
                                                            justifyContent: 'center',
                                                            opacity:
                                                                (game.restart2_111 || 0) > 0
                                                                    ? 0.4
                                                                    : (game.restart2_112 || 0) === 1
                                                                      ? 1
                                                                      : 0.6,
                                                            boxShadow:
                                                                (game.restart2_112 || 0) === 1
                                                                    ? '0 0 10px rgba(255, 215, 0, 0.6)'
                                                                    : 'none'
                                                        }}
                                                    >
                                                        <div
                                                            style={{
                                                                color: '#FFD700',
                                                                fontSize: '14px',
                                                                fontWeight: 'bold'
                                                            }}
                                                        >
                                                            112
                                                        </div>
                                                        {(game.restart2_112 || 0) === 1 && (
                                                            <div
                                                                style={{
                                                                    position: 'absolute',
                                                                    top: '50%',
                                                                    left: '50%',
                                                                    transform: 'translate(-50%, -50%)',
                                                                    color: '#FF0000',
                                                                    fontSize: '40px',
                                                                    fontWeight: 'bold',
                                                                    lineHeight: '1',
                                                                    textShadow: '0 0 4px #000'
                                                                }}
                                                            >
                                                                ✕
                                                            </div>
                                                        )}
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                    <div className={classes.formGroup}>
                                        <label>{pair.team1} Castle:</label>
                                        <div
                                            style={{
                                                display: 'grid',
                                                gridTemplateColumns: 'repeat(6, 1fr)',
                                                gap: '0.5rem',
                                                maxWidth: '600px'
                                            }}
                                        >
                                            {castles.map((c) => (
                                                <img
                                                    key={c}
                                                    src={getCastleImageUrl(c)}
                                                    alt={c}
                                                    title={c}
                                                    style={{
                                                        width: '90px',
                                                        height: '60px',
                                                        border:
                                                            game.castle1 === c
                                                                ? '3px solid #FFD700'
                                                                : '2px solid #00ffff',
                                                        borderRadius: '4px',
                                                        objectFit: 'cover',
                                                        cursor: 'pointer',
                                                        opacity: game.castle1 === c ? 1 : 0.6,
                                                        transform: game.castle1 === c ? 'scale(1.05)' : 'scale(1)',
                                                        transition: 'all 0.2s ease'
                                                    }}
                                                    onClick={() => handleGameResultChange(idx, 'castle1', c)}
                                                />
                                            ))}
                                        </div>
                                    </div>
                                    <div className={classes.formGroup}>
                                        <label>{pair.team2} Castle:</label>
                                        <div
                                            style={{
                                                display: 'grid',
                                                gridTemplateColumns: 'repeat(6, 1fr)',
                                                gap: '0.5rem',
                                                maxWidth: '600px'
                                            }}
                                        >
                                            {castles.map((c) => (
                                                <img
                                                    key={c}
                                                    src={getCastleImageUrl(c)}
                                                    alt={c}
                                                    title={c}
                                                    style={{
                                                        width: '90px',
                                                        height: '60px',
                                                        border:
                                                            game.castle2 === c
                                                                ? '3px solid #FFD700'
                                                                : '2px solid #00ffff',
                                                        borderRadius: '4px',
                                                        objectFit: 'cover',
                                                        cursor: 'pointer',
                                                        opacity: game.castle2 === c ? 1 : 0.6,
                                                        transform: game.castle2 === c ? 'scale(1.05)' : 'scale(1)',
                                                        transition: 'all 0.2s ease'
                                                    }}
                                                    onClick={() => handleGameResultChange(idx, 'castle2', c)}
                                                />
                                            ))}
                                        </div>
                                    </div>
                                    <div className={classes.formGroup}>
                                        <label>Winner:</label>
                                        <div
                                            style={{
                                                display: 'flex',
                                                gap: '1rem',
                                                justifyContent: 'center',
                                                alignItems: 'center'
                                            }}
                                        >
                                            <div
                                                onClick={() => handleGameResultChange(idx, 'winner', pair.team1)}
                                                style={{
                                                    display: 'flex',
                                                    flexDirection: 'column',
                                                    alignItems: 'center',
                                                    cursor: 'pointer',
                                                    padding: '1rem',
                                                    border:
                                                        game.winner === pair.team1
                                                            ? '3px solid #FFD700'
                                                            : '2px solid #00ffff',
                                                    borderRadius: '8px',
                                                    background:
                                                        game.winner === pair.team1
                                                            ? 'rgba(255, 215, 0, 0.1)'
                                                            : 'rgba(0, 255, 255, 0.05)',
                                                    opacity: game.winner === pair.team1 ? 1 : 0.6,
                                                    transform: game.winner === pair.team1 ? 'scale(1.05)' : 'scale(1)',
                                                    transition: 'all 0.2s ease'
                                                }}
                                            >
                                                <div
                                                    style={{
                                                        width: '60px',
                                                        height: '60px',
                                                        borderRadius: '50%',
                                                        background: 'linear-gradient(135deg, #1a1a2e, #16213e)',
                                                        display: 'flex',
                                                        alignItems: 'center',
                                                        justifyContent: 'center',
                                                        fontSize: '24px',
                                                        fontWeight: 'bold',
                                                        color: '#FFD700',
                                                        marginBottom: '0.5rem',
                                                        boxShadow: '0 2px 8px rgba(0, 0, 0, 0.3)'
                                                    }}
                                                >
                                                    {pair.team1.charAt(0).toUpperCase()}
                                                </div>
                                                <div
                                                    style={{ color: '#00ffff', fontSize: '12px', textAlign: 'center' }}
                                                >
                                                    {pair.team1}
                                                </div>
                                            </div>
                                            <div
                                                onClick={() => handleGameResultChange(idx, 'winner', pair.team2)}
                                                style={{
                                                    display: 'flex',
                                                    flexDirection: 'column',
                                                    alignItems: 'center',
                                                    cursor: 'pointer',
                                                    padding: '1rem',
                                                    border:
                                                        game.winner === pair.team2
                                                            ? '3px solid #FFD700'
                                                            : '2px solid #00ffff',
                                                    borderRadius: '8px',
                                                    background:
                                                        game.winner === pair.team2
                                                            ? 'rgba(255, 215, 0, 0.1)'
                                                            : 'rgba(0, 255, 255, 0.05)',
                                                    opacity: game.winner === pair.team2 ? 1 : 0.6,
                                                    transform: game.winner === pair.team2 ? 'scale(1.05)' : 'scale(1)',
                                                    transition: 'all 0.2s ease'
                                                }}
                                            >
                                                <div
                                                    style={{
                                                        width: '60px',
                                                        height: '60px',
                                                        borderRadius: '50%',
                                                        background: 'linear-gradient(135deg, #1a1a2e, #16213e)',
                                                        display: 'flex',
                                                        alignItems: 'center',
                                                        justifyContent: 'center',
                                                        fontSize: '24px',
                                                        fontWeight: 'bold',
                                                        color: '#FFD700',
                                                        marginBottom: '0.5rem',
                                                        boxShadow: '0 2px 8px rgba(0, 0, 0, 0.3)'
                                                    }}
                                                >
                                                    {pair.team2.charAt(0).toUpperCase()}
                                                </div>
                                                <div
                                                    style={{ color: '#00ffff', fontSize: '12px', textAlign: 'center' }}
                                                >
                                                    {pair.team2}
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            ))}
                            <div className={classes.scoreDisplay}>
                                <strong>Current Score:</strong> {pair.team1} {score1} - {score2} {pair.team2}
                            </div>
                        </>
                    ) : (
                        <>
                            {/* BO-1 Game Result */}

                            {/* Compact Score/Winner Section for BO-1 */}
                            <div className={classes.formGroup}>
                                <div
                                    style={{
                                        display: 'flex',
                                        alignItems: 'center',
                                        justifyContent: 'center',
                                        gap: '1rem',
                                        marginBottom: '1rem',
                                        padding: '0.75rem',
                                        background:
                                            'linear-gradient(135deg, rgba(62, 32, 192, 0.2), rgba(45, 20, 150, 0.2))',
                                        borderRadius: '8px',
                                        border: '2px solid #FFD700'
                                    }}
                                >
                                    <div
                                        onClick={() => {
                                            setSelectedWinner(pair.team1);
                                            setScore1(1);
                                            setScore2(0);
                                        }}
                                        style={{
                                            cursor: 'pointer',
                                            padding: '0.5rem 1rem',
                                            borderRadius: '6px',
                                            border:
                                                selectedWinner === pair.team1
                                                    ? '3px solid #FFD700'
                                                    : '2px solid transparent',
                                            background:
                                                selectedWinner === pair.team1
                                                    ? 'rgba(255, 215, 0, 0.2)'
                                                    : 'transparent',
                                            color: '#00ffff',
                                            fontSize: '14px',
                                            fontWeight: 'bold',
                                            opacity: selectedWinner === pair.team1 ? 1 : 0.6,
                                            transition: 'all 0.2s ease'
                                        }}
                                    >
                                        {pair.team1}
                                    </div>
                                    <div
                                        style={{
                                            fontSize: '20px',
                                            fontWeight: 'bold',
                                            color: '#FFD700'
                                        }}
                                    >
                                        {score1} - {score2}
                                    </div>
                                    <div
                                        onClick={() => {
                                            setSelectedWinner(pair.team2);
                                            setScore1(0);
                                            setScore2(1);
                                        }}
                                        style={{
                                            cursor: 'pointer',
                                            padding: '0.5rem 1rem',
                                            borderRadius: '6px',
                                            border:
                                                selectedWinner === pair.team2
                                                    ? '3px solid #FFD700'
                                                    : '2px solid transparent',
                                            background:
                                                selectedWinner === pair.team2
                                                    ? 'rgba(255, 215, 0, 0.2)'
                                                    : 'transparent',
                                            color: '#00ffff',
                                            fontSize: '14px',
                                            fontWeight: 'bold',
                                            opacity: selectedWinner === pair.team2 ? 1 : 0.6,
                                            transition: 'all 0.2s ease'
                                        }}
                                    >
                                        {pair.team2}
                                    </div>
                                </div>
                            </div>

                            {/* Compact Metadata Section for BO-1 */}
                            <div className={classes.formGroup}>
                                <div
                                    style={{
                                        display: 'grid',
                                        gridTemplateColumns: '1fr 1fr 1fr',
                                        gap: '1rem',
                                        padding: '1rem',
                                        background: 'rgba(0, 0, 0, 0.2)',
                                        borderRadius: '8px',
                                        border: '1px solid rgba(0, 255, 255, 0.3)'
                                    }}
                                >
                                    {/* Colors Column */}
                                    <div>
                                        <div
                                            style={{
                                                textAlign: 'center',
                                                marginBottom: '0.5rem',
                                                color: '#FFD700',
                                                fontSize: '12px',
                                                fontWeight: 'bold'
                                            }}
                                        >
                                            Colors
                                        </div>
                                        <div style={{ display: 'flex', gap: '0.5rem', justifyContent: 'center' }}>
                                            <div
                                                onClick={() => {
                                                    setColor1('red');
                                                    setColor2('blue');
                                                }}
                                                style={{
                                                    width: '40px',
                                                    height: '40px',
                                                    borderRadius: '6px',
                                                    background: 'linear-gradient(135deg, #8B0000, #FF0000)',
                                                    border: color1 === 'red' ? '3px solid #FFD700' : '2px solid #4a0000',
                                                    cursor: 'pointer',
                                                    display: 'flex',
                                                    alignItems: 'center',
                                                    justifyContent: 'center',
                                                    opacity: color1 === 'red' ? 1 : 0.5
                                                }}
                                            >
                                                {color1 === 'red' && (
                                                    <span style={{ color: '#FFD700', fontSize: '16px' }}>✓</span>
                                                )}
                                            </div>
                                            <div
                                                onClick={() => {
                                                    setColor1('blue');
                                                    setColor2('red');
                                                }}
                                                style={{
                                                    width: '40px',
                                                    height: '40px',
                                                    borderRadius: '6px',
                                                    background: 'linear-gradient(135deg, #00008B, #0000FF)',
                                                    border: color1 === 'blue' ? '3px solid #FFD700' : '2px solid #000045',
                                                    cursor: 'pointer',
                                                    display: 'flex',
                                                    alignItems: 'center',
                                                    justifyContent: 'center',
                                                    opacity: color1 === 'blue' ? 1 : 0.5
                                                }}
                                            >
                                                {color1 === 'blue' && (
                                                    <span style={{ color: '#FFD700', fontSize: '16px' }}>✓</span>
                                                )}
                                            </div>
                                        </div>
                                    </div>

                                    {/* Gold Column */}
                                    <div>
                                        <div
                                            style={{
                                                textAlign: 'center',
                                                marginBottom: '0.5rem',
                                                color: '#FFD700',
                                                fontSize: '12px',
                                                fontWeight: 'bold'
                                            }}
                                        >
                                            Gold
                                        </div>
                                        <input
                                            type="number"
                                            value={gold1}
                                            onChange={(e) => {
                                                const value = parseInt(e.target.value) || 0;
                                                setGold1(value);
                                                setGold2(-value);
                                            }}
                                            style={{
                                                width: '80px',
                                                padding: '0.4rem',
                                                fontSize: '14px',
                                                textAlign: 'center',
                                                border: '2px solid #FFD700',
                                                borderRadius: '6px',
                                                background: 'rgba(62, 32, 192, 0.2)',
                                                color: gold1 > 0 ? '#00FF00' : gold1 < 0 ? '#FF0000' : '#FFD700',
                                                fontWeight: 'bold'
                                            }}
                                        />
                                    </div>

                                    {/* Restarts Column */}
                                    <div>
                                        <div
                                            style={{
                                                textAlign: 'center',
                                                marginBottom: '0.5rem',
                                                color: '#FFD700',
                                                fontSize: '12px',
                                                fontWeight: 'bold'
                                            }}
                                        >
                                            Restarts
                                        </div>
                                        <div style={{ display: 'flex', gap: '0.25rem', justifyContent: 'center' }}>
                                            {[0, 1].map((boxIdx) => {
                                                const isUsed = restart1_111 > boxIdx;
                                                const isDisabled = restart1_112 > 0;
                                                return (
                                                    <div
                                                        key={`111-${boxIdx}`}
                                                        onClick={() => {
                                                            if (isDisabled) return;
                                                            if (isUsed) {
                                                                setRestart1_111(restart1_111 - 1);
                                                            } else if (restart1_111 < 2) {
                                                                setRestart1_111(restart1_111 + 1);
                                                            }
                                                        }}
                                                        style={{
                                                            position: 'relative',
                                                            width: '35px',
                                                            height: '35px',
                                                            border: '2px solid #FFD700',
                                                            borderRadius: '4px',
                                                            background: isDisabled
                                                                ? 'rgba(0, 0, 0, 0.5)'
                                                                : isUsed
                                                                  ? 'rgba(62, 32, 192, 0.3)'
                                                                  : 'rgba(0, 0, 0, 0.3)',
                                                            cursor: isDisabled ? 'not-allowed' : 'pointer',
                                                            display: 'flex',
                                                            alignItems: 'center',
                                                            justifyContent: 'center',
                                                            opacity: isDisabled ? 0.4 : isUsed ? 1 : 0.5,
                                                            fontSize: '10px',
                                                            color: '#FFD700',
                                                            fontWeight: 'bold'
                                                        }}
                                                    >
                                                        111
                                                        {isUsed && (
                                                            <div
                                                                style={{
                                                                    position: 'absolute',
                                                                    fontSize: '28px',
                                                                    color: '#FF0000'
                                                                }}
                                                            >
                                                                ✕
                                                            </div>
                                                        )}
                                                    </div>
                                                );
                                            })}
                                            <div
                                                onClick={() => {
                                                    if (restart1_111 > 0) return;
                                                    setRestart1_112(restart1_112 === 1 ? 0 : 1);
                                                }}
                                                style={{
                                                    position: 'relative',
                                                    width: '35px',
                                                    height: '35px',
                                                    border: '2px solid #FFD700',
                                                    borderRadius: '4px',
                                                    background:
                                                        restart1_111 > 0
                                                            ? 'rgba(0, 0, 0, 0.5)'
                                                            : restart1_112 === 1
                                                              ? 'rgba(62, 32, 192, 0.3)'
                                                              : 'rgba(0, 0, 0, 0.3)',
                                                    cursor: restart1_111 > 0 ? 'not-allowed' : 'pointer',
                                                    display: 'flex',
                                                    alignItems: 'center',
                                                    justifyContent: 'center',
                                                    opacity: restart1_111 > 0 ? 0.4 : restart1_112 === 1 ? 1 : 0.5,
                                                    fontSize: '10px',
                                                    color: '#FFD700',
                                                    fontWeight: 'bold'
                                                }}
                                            >
                                                112
                                                {restart1_112 === 1 && (
                                                    <div
                                                        style={{
                                                            position: 'absolute',
                                                            fontSize: '28px',
                                                            color: '#FF0000'
                                                        }}
                                                    >
                                                        ✕
                                                    </div>
                                                )}
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div className={classes.formGroup}>
                                <label>Player Colors:</label>
                                <div
                                    style={{
                                        display: 'flex',
                                        gap: '2rem',
                                        justifyContent: 'center',
                                        marginBottom: '1rem'
                                    }}
                                >
                                    <div style={{ textAlign: 'center' }}>
                                        <div style={{ marginBottom: '0.5rem', color: '#00ffff', fontSize: '14px' }}>
                                            {pair.team1}
                                        </div>
                                        <div style={{ display: 'flex', gap: '0.5rem' }}>
                                            <div
                                                onClick={() => {
                                                    setColor1('red');
                                                    setColor2('blue');
                                                }}
                                                style={{
                                                    width: '60px',
                                                    height: '60px',
                                                    borderRadius: '8px',
                                                    background: 'linear-gradient(135deg, #8B0000, #FF0000, #DC143C)',
                                                    border:
                                                        color1 === 'red' ? '4px solid #FFD700' : '3px solid #4a0000',
                                                    cursor: 'pointer',
                                                    boxShadow:
                                                        color1 === 'red'
                                                            ? '0 0 20px rgba(255, 0, 0, 0.8), inset 0 0 20px rgba(255, 255, 255, 0.2)'
                                                            : '0 4px 8px rgba(0, 0, 0, 0.5), inset 0 2px 4px rgba(255, 255, 255, 0.1)',
                                                    transform: color1 === 'red' ? 'scale(1.1)' : 'scale(1)',
                                                    transition: 'all 0.2s ease',
                                                    display: 'flex',
                                                    alignItems: 'center',
                                                    justifyContent: 'center'
                                                }}
                                            >
                                                {color1 === 'red' && (
                                                    <span
                                                        style={{
                                                            color: '#FFD700',
                                                            fontSize: '24px',
                                                            fontWeight: 'bold'
                                                        }}
                                                    >
                                                        ✓
                                                    </span>
                                                )}
                                            </div>
                                            <div
                                                onClick={() => {
                                                    setColor1('blue');
                                                    setColor2('red');
                                                }}
                                                style={{
                                                    width: '60px',
                                                    height: '60px',
                                                    borderRadius: '8px',
                                                    background: 'linear-gradient(135deg, #00008B, #0000FF, #4169E1)',
                                                    border:
                                                        color1 === 'blue' ? '4px solid #FFD700' : '3px solid #000045',
                                                    cursor: 'pointer',
                                                    boxShadow:
                                                        color1 === 'blue'
                                                            ? '0 0 20px rgba(0, 0, 255, 0.8), inset 0 0 20px rgba(255, 255, 255, 0.2)'
                                                            : '0 4px 8px rgba(0, 0, 0, 0.5), inset 0 2px 4px rgba(255, 255, 255, 0.1)',
                                                    transform: color1 === 'blue' ? 'scale(1.1)' : 'scale(1)',
                                                    transition: 'all 0.2s ease',
                                                    display: 'flex',
                                                    alignItems: 'center',
                                                    justifyContent: 'center'
                                                }}
                                            >
                                                {color1 === 'blue' && (
                                                    <span
                                                        style={{
                                                            color: '#FFD700',
                                                            fontSize: '24px',
                                                            fontWeight: 'bold'
                                                        }}
                                                    >
                                                        ✓
                                                    </span>
                                                )}
                                            </div>
                                        </div>
                                    </div>
                                    <div style={{ textAlign: 'center' }}>
                                        <div style={{ marginBottom: '0.5rem', color: '#00ffff', fontSize: '14px' }}>
                                            {pair.team2}
                                        </div>
                                        <div style={{ display: 'flex', gap: '0.5rem' }}>
                                            <div
                                                onClick={() => {
                                                    setColor2('red');
                                                    setColor1('blue');
                                                }}
                                                style={{
                                                    width: '60px',
                                                    height: '60px',
                                                    borderRadius: '8px',
                                                    background: 'linear-gradient(135deg, #8B0000, #FF0000, #DC143C)',
                                                    border:
                                                        color2 === 'red' ? '4px solid #FFD700' : '3px solid #4a0000',
                                                    cursor: 'pointer',
                                                    boxShadow:
                                                        color2 === 'red'
                                                            ? '0 0 20px rgba(255, 0, 0, 0.8), inset 0 0 20px rgba(255, 255, 255, 0.2)'
                                                            : '0 4px 8px rgba(0, 0, 0, 0.5), inset 0 2px 4px rgba(255, 255, 255, 0.1)',
                                                    transform: color2 === 'red' ? 'scale(1.1)' : 'scale(1)',
                                                    transition: 'all 0.2s ease',
                                                    display: 'flex',
                                                    alignItems: 'center',
                                                    justifyContent: 'center'
                                                }}
                                            >
                                                {color2 === 'red' && (
                                                    <span
                                                        style={{
                                                            color: '#FFD700',
                                                            fontSize: '24px',
                                                            fontWeight: 'bold'
                                                        }}
                                                    >
                                                        ✓
                                                    </span>
                                                )}
                                            </div>
                                            <div
                                                onClick={() => {
                                                    setColor2('blue');
                                                    setColor1('red');
                                                }}
                                                style={{
                                                    width: '60px',
                                                    height: '60px',
                                                    borderRadius: '8px',
                                                    background: 'linear-gradient(135deg, #00008B, #0000FF, #4169E1)',
                                                    border:
                                                        color2 === 'blue' ? '4px solid #FFD700' : '3px solid #000045',
                                                    cursor: 'pointer',
                                                    boxShadow:
                                                        color2 === 'blue'
                                                            ? '0 0 20px rgba(0, 0, 255, 0.8), inset 0 0 20px rgba(255, 255, 255, 0.2)'
                                                            : '0 4px 8px rgba(0, 0, 0, 0.5), inset 0 2px 4px rgba(255, 255, 255, 0.1)',
                                                    transform: color2 === 'blue' ? 'scale(1.1)' : 'scale(1)',
                                                    transition: 'all 0.2s ease',
                                                    display: 'flex',
                                                    alignItems: 'center',
                                                    justifyContent: 'center'
                                                }}
                                            >
                                                {color2 === 'blue' && (
                                                    <span
                                                        style={{
                                                            color: '#FFD700',
                                                            fontSize: '24px',
                                                            fontWeight: 'bold'
                                                        }}
                                                    >
                                                        ✓
                                                    </span>
                                                )}
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            {/* Gold Input for BO-1 */}
                            <div className={classes.formGroup}>
                                <label>Gold Advantage:</label>
                                <div
                                    style={{
                                        display: 'flex',
                                        gap: '2rem',
                                        justifyContent: 'center',
                                        alignItems: 'center',
                                        marginBottom: '1rem'
                                    }}
                                >
                                    <div style={{ textAlign: 'center' }}>
                                        <div style={{ marginBottom: '0.5rem', color: '#00ffff', fontSize: '14px' }}>
                                            {pair.team1}
                                        </div>
                                        <input
                                            type="number"
                                            value={gold1}
                                            onChange={(e) => {
                                                const value = parseInt(e.target.value) || 0;
                                                setGold1(value);
                                                setGold2(-value);
                                            }}
                                            style={{
                                                width: '120px',
                                                padding: '0.5rem',
                                                fontSize: '16px',
                                                textAlign: 'center',
                                                border: '3px solid #FFD700',
                                                borderRadius: '8px',
                                                background:
                                                    'linear-gradient(135deg, rgba(62, 32, 192, 0.3), rgba(45, 20, 150, 0.3))',
                                                color: gold1 > 0 ? '#00FF00' : gold1 < 0 ? '#FF0000' : '#FFD700',
                                                fontWeight: 'bold',
                                                boxShadow:
                                                    '0 2px 8px rgba(62, 32, 192, 0.3), inset 0 1px 2px rgba(255, 215, 0, 0.1)'
                                            }}
                                        />
                                    </div>
                                    <div style={{ color: '#FFD700', fontSize: '24px', fontWeight: 'bold' }}>⚔️</div>
                                    <div style={{ textAlign: 'center' }}>
                                        <div style={{ marginBottom: '0.5rem', color: '#00ffff', fontSize: '14px' }}>
                                            {pair.team2}
                                        </div>
                                        <input
                                            type="number"
                                            value={gold2}
                                            onChange={(e) => {
                                                const value = parseInt(e.target.value) || 0;
                                                setGold2(value);
                                                setGold1(-value);
                                            }}
                                            style={{
                                                width: '120px',
                                                padding: '0.5rem',
                                                fontSize: '16px',
                                                textAlign: 'center',
                                                border: '3px solid #FFD700',
                                                borderRadius: '8px',
                                                background:
                                                    'linear-gradient(135deg, rgba(62, 32, 192, 0.3), rgba(45, 20, 150, 0.3))',
                                                color: gold2 > 0 ? '#00FF00' : gold2 < 0 ? '#FF0000' : '#FFD700',
                                                fontWeight: 'bold',
                                                boxShadow:
                                                    '0 2px 8px rgba(62, 32, 192, 0.3), inset 0 1px 2px rgba(255, 215, 0, 0.1)'
                                            }}
                                        />
                                    </div>
                                </div>
                            </div>

                            {/* Restarts Input for BO-1 */}
                            <div className={classes.formGroup}>
                                <label>Restarts:</label>
                                <div
                                    style={{
                                        display: 'flex',
                                        gap: '2rem',
                                        justifyContent: 'center',
                                        marginBottom: '1rem'
                                    }}
                                >
                                    <div style={{ textAlign: 'center' }}>
                                        <div style={{ marginBottom: '0.5rem', color: '#00ffff', fontSize: '14px' }}>
                                            {pair.team1}
                                        </div>
                                        <div style={{ display: 'flex', gap: '0.5rem', alignItems: 'center' }}>
                                            {/* 111 Restart Boxes */}
                                            {[0, 1].map((boxIdx) => {
                                                const isUsed = restart1_111 > boxIdx;
                                                const isDisabled = restart1_112 > 0;
                                                return (
                                                    <div
                                                        key={`111-${boxIdx}`}
                                                        onClick={() => {
                                                            if (isDisabled) return;
                                                            if (isUsed) {
                                                                setRestart1_111(restart1_111 - 1);
                                                            } else if (restart1_111 < 2) {
                                                                setRestart1_111(restart1_111 + 1);
                                                            }
                                                        }}
                                                        style={{
                                                            position: 'relative',
                                                            width: '50px',
                                                            height: '50px',
                                                            border: '2px solid #FFD700',
                                                            borderRadius: '4px',
                                                            background: isDisabled
                                                                ? 'rgba(0, 0, 0, 0.5)'
                                                                : isUsed
                                                                  ? 'linear-gradient(135deg, rgba(62, 32, 192, 0.3), rgba(45, 20, 150, 0.3))'
                                                                  : 'rgba(0, 0, 0, 0.3)',
                                                            cursor: isDisabled ? 'not-allowed' : 'pointer',
                                                            display: 'flex',
                                                            alignItems: 'center',
                                                            justifyContent: 'center',
                                                            opacity: isDisabled ? 0.4 : isUsed ? 1 : 0.6,
                                                            boxShadow: isUsed
                                                                ? '0 0 10px rgba(255, 215, 0, 0.6)'
                                                                : 'none'
                                                        }}
                                                    >
                                                        <div
                                                            style={{
                                                                color: '#FFD700',
                                                                fontSize: '14px',
                                                                fontWeight: 'bold'
                                                            }}
                                                        >
                                                            111
                                                        </div>
                                                        {isUsed && (
                                                            <div
                                                                style={{
                                                                    position: 'absolute',
                                                                    top: '50%',
                                                                    left: '50%',
                                                                    transform: 'translate(-50%, -50%)',
                                                                    color: '#FF0000',
                                                                    fontSize: '40px',
                                                                    fontWeight: 'bold',
                                                                    lineHeight: '1',
                                                                    textShadow: '0 0 4px #000'
                                                                }}
                                                            >
                                                                ✕
                                                            </div>
                                                        )}
                                                    </div>
                                                );
                                            })}
                                            {/* 112 Restart Box */}
                                            <div
                                                onClick={() => {
                                                    if (restart1_111 > 0) return;
                                                    setRestart1_112(restart1_112 === 1 ? 0 : 1);
                                                }}
                                                style={{
                                                    position: 'relative',
                                                    width: '50px',
                                                    height: '50px',
                                                    border: '2px solid #FFD700',
                                                    borderRadius: '4px',
                                                    background:
                                                        restart1_111 > 0
                                                            ? 'rgba(0, 0, 0, 0.5)'
                                                            : restart1_112 === 1
                                                              ? 'linear-gradient(135deg, rgba(62, 32, 192, 0.3), rgba(45, 20, 150, 0.3))'
                                                              : 'rgba(0, 0, 0, 0.3)',
                                                    cursor: restart1_111 > 0 ? 'not-allowed' : 'pointer',
                                                    display: 'flex',
                                                    alignItems: 'center',
                                                    justifyContent: 'center',
                                                    opacity: restart1_111 > 0 ? 0.4 : restart1_112 === 1 ? 1 : 0.6,
                                                    boxShadow:
                                                        restart1_112 === 1 ? '0 0 10px rgba(255, 215, 0, 0.6)' : 'none'
                                                }}
                                            >
                                                <div
                                                    style={{
                                                        color: '#FFD700',
                                                        fontSize: '14px',
                                                        fontWeight: 'bold'
                                                    }}
                                                >
                                                    112
                                                </div>
                                                {restart1_112 === 1 && (
                                                    <div
                                                        style={{
                                                            position: 'absolute',
                                                            top: '50%',
                                                            left: '50%',
                                                            transform: 'translate(-50%, -50%)',
                                                            color: '#FF0000',
                                                            fontSize: '40px',
                                                            fontWeight: 'bold',
                                                            lineHeight: '1',
                                                            textShadow: '0 0 4px #000'
                                                        }}
                                                    >
                                                        ✕
                                                    </div>
                                                )}
                                            </div>
                                        </div>
                                    </div>
                                    <div style={{ textAlign: 'center' }}>
                                        <div style={{ marginBottom: '0.5rem', color: '#00ffff', fontSize: '14px' }}>
                                            {pair.team2}
                                        </div>
                                        <div style={{ display: 'flex', gap: '0.5rem', alignItems: 'center' }}>
                                            {/* 111 Restart Boxes */}
                                            {[0, 1].map((boxIdx) => {
                                                const isUsed = restart2_111 > boxIdx;
                                                const isDisabled = restart2_112 > 0;
                                                return (
                                                    <div
                                                        key={`111-${boxIdx}`}
                                                        onClick={() => {
                                                            if (isDisabled) return;
                                                            if (isUsed) {
                                                                setRestart2_111(restart2_111 - 1);
                                                            } else if (restart2_111 < 2) {
                                                                setRestart2_111(restart2_111 + 1);
                                                            }
                                                        }}
                                                        style={{
                                                            position: 'relative',
                                                            width: '50px',
                                                            height: '50px',
                                                            border: '2px solid #FFD700',
                                                            borderRadius: '4px',
                                                            background: isDisabled
                                                                ? 'rgba(0, 0, 0, 0.5)'
                                                                : isUsed
                                                                  ? 'linear-gradient(135deg, rgba(62, 32, 192, 0.3), rgba(45, 20, 150, 0.3))'
                                                                  : 'rgba(0, 0, 0, 0.3)',
                                                            cursor: isDisabled ? 'not-allowed' : 'pointer',
                                                            display: 'flex',
                                                            alignItems: 'center',
                                                            justifyContent: 'center',
                                                            opacity: isDisabled ? 0.4 : isUsed ? 1 : 0.6,
                                                            boxShadow: isUsed
                                                                ? '0 0 10px rgba(255, 215, 0, 0.6)'
                                                                : 'none'
                                                        }}
                                                    >
                                                        <div
                                                            style={{
                                                                color: '#FFD700',
                                                                fontSize: '14px',
                                                                fontWeight: 'bold'
                                                            }}
                                                        >
                                                            111
                                                        </div>
                                                        {isUsed && (
                                                            <div
                                                                style={{
                                                                    position: 'absolute',
                                                                    top: '50%',
                                                                    left: '50%',
                                                                    transform: 'translate(-50%, -50%)',
                                                                    color: '#FF0000',
                                                                    fontSize: '40px',
                                                                    fontWeight: 'bold',
                                                                    lineHeight: '1',
                                                                    textShadow: '0 0 4px #000'
                                                                }}
                                                            >
                                                                ✕
                                                            </div>
                                                        )}
                                                    </div>
                                                );
                                            })}
                                            {/* 112 Restart Box */}
                                            <div
                                                onClick={() => {
                                                    if (restart2_111 > 0) return;
                                                    setRestart2_112(restart2_112 === 1 ? 0 : 1);
                                                }}
                                                style={{
                                                    position: 'relative',
                                                    width: '50px',
                                                    height: '50px',
                                                    border: '2px solid #FFD700',
                                                    borderRadius: '4px',
                                                    background:
                                                        restart2_111 > 0
                                                            ? 'rgba(0, 0, 0, 0.5)'
                                                            : restart2_112 === 1
                                                              ? 'linear-gradient(135deg, rgba(62, 32, 192, 0.3), rgba(45, 20, 150, 0.3))'
                                                              : 'rgba(0, 0, 0, 0.3)',
                                                    cursor: restart2_111 > 0 ? 'not-allowed' : 'pointer',
                                                    display: 'flex',
                                                    alignItems: 'center',
                                                    justifyContent: 'center',
                                                    opacity: restart2_111 > 0 ? 0.4 : restart2_112 === 1 ? 1 : 0.6,
                                                    boxShadow:
                                                        restart2_112 === 1 ? '0 0 10px rgba(255, 215, 0, 0.6)' : 'none'
                                                }}
                                            >
                                                <div
                                                    style={{
                                                        color: '#FFD700',
                                                        fontSize: '14px',
                                                        fontWeight: 'bold'
                                                    }}
                                                >
                                                    112
                                                </div>
                                                {restart2_112 === 1 && (
                                                    <div
                                                        style={{
                                                            position: 'absolute',
                                                            top: '50%',
                                                            left: '50%',
                                                            transform: 'translate(-50%, -50%)',
                                                            color: '#FF0000',
                                                            fontSize: '40px',
                                                            fontWeight: 'bold',
                                                            lineHeight: '1',
                                                            textShadow: '0 0 4px #000'
                                                        }}
                                                    >
                                                        ✕
                                                    </div>
                                                )}
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div className={classes.formGroup}>
                                <label>{pair.team1} Castle:</label>
                                <div
                                    style={{
                                        display: 'grid',
                                        gridTemplateColumns: 'repeat(6, 1fr)',
                                        gap: '0.5rem',
                                        maxWidth: '600px'
                                    }}
                                >
                                    {castles.map((c) => (
                                        <img
                                            key={c}
                                            src={getCastleImageUrl(c)}
                                            alt={c}
                                            title={c}
                                            style={{
                                                width: '90px',
                                                height: '60px',
                                                border: castle1 === c ? '3px solid #FFD700' : '2px solid #00ffff',
                                                borderRadius: '4px',
                                                objectFit: 'cover',
                                                cursor: 'pointer',
                                                opacity: castle1 === c ? 1 : 0.6,
                                                transform: castle1 === c ? 'scale(1.05)' : 'scale(1)',
                                                transition: 'all 0.2s ease'
                                            }}
                                            onClick={() => setCastle1(c)}
                                        />
                                    ))}
                                </div>
                            </div>
                            <div className={classes.formGroup}>
                                <label>{pair.team2} Castle:</label>
                                <div
                                    style={{
                                        display: 'grid',
                                        gridTemplateColumns: 'repeat(6, 1fr)',
                                        gap: '0.5rem',
                                        maxWidth: '600px'
                                    }}
                                >
                                    {castles.map((c) => (
                                        <img
                                            key={c}
                                            src={getCastleImageUrl(c)}
                                            alt={c}
                                            title={c}
                                            style={{
                                                width: '90px',
                                                height: '60px',
                                                border: castle2 === c ? '3px solid #FFD700' : '2px solid #00ffff',
                                                borderRadius: '4px',
                                                objectFit: 'cover',
                                                cursor: 'pointer',
                                                opacity: castle2 === c ? 1 : 0.6,
                                                transform: castle2 === c ? 'scale(1.05)' : 'scale(1)',
                                                transition: 'all 0.2s ease'
                                            }}
                                            onClick={() => setCastle2(c)}
                                        />
                                    ))}
                                </div>
                            </div>
                            <div className={classes.formGroup}>
                                <label>Winner:</label>
                                <div
                                    style={{
                                        display: 'flex',
                                        gap: '1rem',
                                        justifyContent: 'center',
                                        alignItems: 'center'
                                    }}
                                >
                                    <div
                                        onClick={() => {
                                            setSelectedWinner(pair.team1);
                                            setScore1(1);
                                            setScore2(0);
                                        }}
                                        style={{
                                            display: 'flex',
                                            flexDirection: 'column',
                                            alignItems: 'center',
                                            cursor: 'pointer',
                                            padding: '1rem',
                                            border:
                                                selectedWinner === pair.team1
                                                    ? '3px solid #FFD700'
                                                    : '2px solid #00ffff',
                                            borderRadius: '8px',
                                            background:
                                                selectedWinner === pair.team1
                                                    ? 'rgba(255, 215, 0, 0.1)'
                                                    : 'rgba(0, 255, 255, 0.05)',
                                            opacity: selectedWinner === pair.team1 ? 1 : 0.6,
                                            transform: selectedWinner === pair.team1 ? 'scale(1.05)' : 'scale(1)',
                                            transition: 'all 0.2s ease'
                                        }}
                                    >
                                        <div
                                            style={{
                                                width: '60px',
                                                height: '60px',
                                                borderRadius: '50%',
                                                background: 'linear-gradient(135deg, #1a1a2e, #16213e)',
                                                display: 'flex',
                                                alignItems: 'center',
                                                justifyContent: 'center',
                                                fontSize: '24px',
                                                fontWeight: 'bold',
                                                color: '#FFD700',
                                                marginBottom: '0.5rem',
                                                boxShadow: '0 2px 8px rgba(0, 0, 0, 0.3)'
                                            }}
                                        >
                                            {pair.team1.charAt(0).toUpperCase()}
                                        </div>
                                        <div
                                            style={{
                                                color: '#00ffff',
                                                fontSize: '12px',
                                                textAlign: 'center'
                                            }}
                                        >
                                            {pair.team1}
                                        </div>
                                    </div>
                                    <div
                                        onClick={() => {
                                            setSelectedWinner(pair.team2);
                                            setScore1(0);
                                            setScore2(1);
                                        }}
                                        style={{
                                            display: 'flex',
                                            flexDirection: 'column',
                                            alignItems: 'center',
                                            cursor: 'pointer',
                                            padding: '1rem',
                                            border:
                                                selectedWinner === pair.team2
                                                    ? '3px solid #FFD700'
                                                    : '2px solid #00ffff',
                                            borderRadius: '8px',
                                            background:
                                                selectedWinner === pair.team2
                                                    ? 'rgba(255, 215, 0, 0.1)'
                                                    : 'rgba(0, 255, 255, 0.05)',
                                            opacity: selectedWinner === pair.team2 ? 1 : 0.6,
                                            transform: selectedWinner === pair.team2 ? 'scale(1.05)' : 'scale(1)',
                                            transition: 'all 0.2s ease'
                                        }}
                                    >
                                        <div
                                            style={{
                                                width: '60px',
                                                height: '60px',
                                                borderRadius: '50%',
                                                background: 'linear-gradient(135deg, #1a1a2e, #16213e)',
                                                display: 'flex',
                                                alignItems: 'center',
                                                justifyContent: 'center',
                                                fontSize: '24px',
                                                fontWeight: 'bold',
                                                color: '#FFD700',
                                                marginBottom: '0.5rem',
                                                boxShadow: '0 2px 8px rgba(0, 0, 0, 0.3)'
                                            }}
                                        >
                                            {pair.team2.charAt(0).toUpperCase()}
                                        </div>
                                        <div
                                            style={{
                                                color: '#00ffff',
                                                fontSize: '12px',
                                                textAlign: 'center'
                                            }}
                                        >
                                            {pair.team2}
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div className={classes.scoreDisplay}>
                                <strong>Score:</strong> {pair.team1} {score1} - {score2} {pair.team2}
                            </div>
                        </>
                    )}

                    <div className={classes.buttonGroup}>
                        <button type="submit" className={classes.submitButton}>
                            Submit Result
                        </button>
                        <button type="button" onClick={onClose} className={classes.cancelButton}>
                            Cancel
                        </button>
                    </div>
                </form>
            </div>
        </div>
    );
};

export default ReportGameModal;
